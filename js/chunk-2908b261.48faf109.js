(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2908b261","chunk-28be4a2c"],{"0817":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("1da1"),i=(r("96cf"),r("99af"),r("b0c0"),r("2423")),n=r("ff41"),o=r.n(n),l=(r("2f2f"),{data:function(){return{ruleForm:{title:"",tags:[],content:"",categoryId:void 0,type:"1",cover:"",articleUrl:""},fileList:[],coverType:"默认",contentEditor:{},options:[],rules:{title:[{required:!0,message:"请输入话题名称",trigger:"blur"},{min:1,max:25,message:"长度在 1 到 25 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"请选择分类",trigger:"change"}]},showUrl:!1}},computed:{getRadio:function(){return this.ruleForm.type}},watch:{getRadio:function(e){this.showUrl="0"===e}},methods:{renderMarkdown:function(e){this.contentEditor=new o.a("vditor",{height:500,placeholder:"此处为话题内容……",theme:"classic",value:e,counter:{enable:!0,type:"markdown"},preview:{delay:0,hljs:{style:"native",lineNumber:!1}},tab:"\t",typewriterMode:!0,cache:{enable:!1},upload:{fieldName:"file",handler:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(i["n"])(e[0]);case 2:a=r.sent,n="",t.contentEditor&&"wysiwyg"===t.contentEditor.vditor.currentMode?n+="\n <img alt=".concat(e[0].name,' src="').concat(a.data,'">'):n+="\n![".concat(e[0].name,"](").concat(a.data,")"),document.execCommand("insertHTML",!1,n);case 6:case"end":return r.stop()}}),r)})))()},accept:"image/*,.mp3, .wav, .rar"}})},getCategory:function(){var e=this;Object(i["e"])().then((function(t){e.options=t.data}))},coverUpload:function(e){var t=this;Object(i["n"])(e.file).then((function(e){t.ruleForm.cover=e.data}))},submitForm:function(e,t){var r=this;this.ruleForm["draft"]=t,this.$refs[e].validate((function(e){return e?1===r.contentEditor.getValue().length||null==r.contentEditor.getValue()||""===r.contentEditor.getValue()?(r.$message({type:"warning",message:"话题内容不可为空"}),r.contentEditor.focus(),!1):(r.ruleForm.content=r.contentEditor.getValue(),r.showUrl&&""===r.ruleForm.articleUrl?(r.$message({type:"warning",message:"转载请注明出处"}),void r.$refs.type.focus()):void r.handle(r.ruleForm)):(console.log("error submit!!"),r.$refs.title.focus(),!1)}))},resetForm:function(e){this.$refs[e].resetFields(),this.contentEditor.setValue(""),this.ruleForm.tags=[],this.ruleForm.cover=""}}})},"10cf":function(e,t,r){},"214f":function(e,t,r){"use strict";r("10cf")},"29e4":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[r("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[],n=(r("a9e3"),r("09f4")),o={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&Object(n["a"])(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&Object(n["a"])(0,800)}}},l=o,s=(r("214f"),r("2877")),c=Object(s["a"])(l,a,i,!1,null,"744c2192",null);t["a"]=c.exports},7801:function(e,t,r){"use strict";r("bb3c")},8622:function(e,t,r){"use strict";r("b3ad")},"910f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-full"},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("div",[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules}},[r("el-form-item",{attrs:{prop:"title"}},[r("el-input",{ref:"title",attrs:{placeholder:"输入主题名称"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{prop:"categoryId"}},[r("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}},e._l(e.options,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{prop:"content"}},[r("div",{attrs:{id:"vditor"}})]),r("b-taginput",{ref:"tagInput",staticClass:"my-3",attrs:{maxlength:"5",maxtags:"5",ellipsis:"",type:"is-info",placeholder:"请输入主题标签，限制为 5 个字符和 5 个标签"},model:{value:e.ruleForm.tags,callback:function(t){e.$set(e.ruleForm,"tags",t)},expression:"ruleForm.tags"}}),r("div",{staticClass:"cover-upload"},[r("div",{staticClass:"cover_upload_selectType"},[r("el-radio-group",{model:{value:e.coverType,callback:function(t){e.coverType=t},expression:"coverType"}},[r("el-radio-button",{attrs:{label:"默认"}}),r("el-radio-button",{attrs:{label:"外链"}})],1)],1),"默认"===e.coverType?r("div",{staticClass:"cover_up"},[r("el-upload",{attrs:{drag:"",action:"#","http-request":e.coverUpload,"file-list":e.fileList,disabled:""!==e.ruleForm.cover}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),r("em",[e._v("点击上传")])])]),r("div",{staticClass:"cover_up_preview"},[r("el-image",{staticStyle:{width:"100%",height:"180px"},attrs:{src:e.ruleForm.cover}})],1)],1):r("div",[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.cover,callback:function(t){e.$set(e.ruleForm,"cover",t)},expression:"ruleForm.cover"}}),r("el-image",{staticClass:"cover_in",staticStyle:{width:"360px",height:"180px"},attrs:{src:e.ruleForm.cover}})],1)]),r("div",{staticClass:"type"},[r("el-radio",{attrs:{label:"1"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[e._v("原创")]),r("el-radio",{attrs:{label:"0"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[e._v("转载")]),r("el-input",{directives:[{name:"show",rawName:"v-show",value:e.showUrl,expression:"showUrl"}],ref:"type",staticStyle:{"margin-top":"2px"},attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.articleUrl,callback:function(t){e.$set(e.ruleForm,"articleUrl",t)},expression:"ruleForm.articleUrl"}})],1),r("el-form-item",{staticClass:"post_button"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm",!1)}}},[e._v("发布 ")]),r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submitForm("ruleForm",!0)}}},[e._v("草稿 ")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])],1)])},i=[],n=(r("a9e3"),r("2423")),o=r("0817"),l={name:"Update",data:function(){return{}},mixins:[o["a"]],props:{articleId:{required:!0,type:Number}},created:function(){this.getCategory()},mounted:function(){var e=this;this.$nextTick((function(){e.getUpdateArticle()}))},methods:{getUpdateArticle:function(){var e=this;Object(n["h"])(this.articleId).then((function(t){e.ruleForm=t.data,e.renderMarkdown(t.data.content)}))},handle:function(e){var t=this;Object(n["j"])(e).then((function(e){200===e.code&&(t.$message({type:"success",message:"发布成功!"}),t.resetForm("ruleForm"))}))}}},s=l,c=(r("7801"),r("2877")),u=Object(c["a"])(s,a,i,!1,null,null,null);t["default"]=u.exports},b3ad:function(e,t,r){},bb3c:function(e,t,r){},e992:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"table",staticClass:"tableClass",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[r("el-table-column",{attrs:{prop:"articleId",label:"编号",sortable:"",width:"100px"}}),r("el-table-column",{attrs:{prop:"title",label:"标题","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{prop:"cover",label:"封面"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-image",{attrs:{src:t.cover,"preview-src-list":[t.cover]}})]}}])}),r("el-table-column",{attrs:{prop:"category",label:"分类"}}),r("el-table-column",{attrs:{prop:"tag",label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},e._l(a.tags,(function(t,a){return r("el-tag",{key:a,staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini","disable-transitions":""}},[e._v(" "+e._s(t)+" ")])})),1)]}}])}),r("el-table-column",{attrs:{prop:"draft",label:"草稿",width:"100",filters:[{text:"草稿",value:!0},{text:"已发布",value:!1}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.draft?"点击发布":"点击撤销",placement:"top"}},[r("el-tag",{staticStyle:{cursor:"pointer"},attrs:{type:a.draft?"danger":"success","disable-transitions":""},on:{click:function(t){return e.switchControl(!a.draft,a,"draft")}}},[e._v(e._s(a.draft?"草稿":"正文")+" ")])],1)]}}])}),r("el-table-column",{attrs:{prop:"top",label:"置顶"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{content:t.row.top?"置顶":"不置顶",placement:"top"}},[r("el-switch",{ref:"switch",on:{change:function(r){return e.switchControl(r,t.row,"top")}},model:{value:t.row.top,callback:function(r){e.$set(t.row,"top",r)},expression:"scope.row.top"}})],1)]}}])}),r("el-table-column",{attrs:{prop:"essence",label:"精贴"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-tooltip",{attrs:{content:a["essence"]?"精贴":"非精贴",placement:"top"}},[r("el-switch",{on:{change:function(t){return e.switchControl(t,a,"essence")}},model:{value:a["essence"],callback:function(t){e.$set(a,"essence",t)},expression:"row['essence']"}})],1)]}}])}),r("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-date-picker",{attrs:{type:"datetime","picker-options":e.pickerOptions,placeholder:"选择日期时间"},on:{change:function(t){return e.updateCreateTime(a.articleId,t)}},model:{value:a["createTime"],callback:function(t){e.$set(a,"createTime",t)},expression:"row['createTime']"}})]}}])}),r("el-table-column",{attrs:{prop:"modifyTime",label:"更新时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[null==a.modifyTime?r("p",[e._v(" 暂未更新 ")]):r("p",[e._v(e._s(e.dayjs(a["modifyTime"]).format("YYYY-MM-DD HH:mm:ss")))])]}}])}),r("el-table-column",{staticStyle:{"background-color":"red"},attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-postcard"},nativeOn:{click:function(r){return r.preventDefault(),e.viewTopic(t.row)}}}),r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},nativeOn:{click:function(r){return r.preventDefault(),e.updateTopic(t.row)}}}),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},nativeOn:{click:function(r){return r.preventDefault(),e.deleteRow(t.$index,e.tableData,t.row)}}})]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.pageNo,limit:e.listQuery.size},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNo",t)},"update:limit":function(t){return e.$set(e.listQuery,"size",t)},pagination:e.getList}}),r("el-dialog",{attrs:{title:"文章修改",width:"100%",visible:e.dialogUpdateVisible},on:{"update:visible":function(t){e.dialogUpdateVisible=t}}},[e.dialogUpdateVisible?r("Update",{attrs:{"article-id":e.articleId}}):e._e()],1),r("el-dialog",{attrs:{title:"详情",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[e.dialogTableVisible?r("TopicDetail",{attrs:{id:e.articleId}}):e._e()],1)],1)},i=[],n=r("1da1"),o=(r("a434"),r("96cf"),r("2423")),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"preview"}})},s=[],c=(r("a9e3"),r("ff41")),u=r.n(c),d=(r("2f2f"),{name:"TopicDetail",data:function(){return{flag:!1}},props:{id:{type:Number,required:!0}},mounted:function(){this.fetchTopic()},methods:{renderMarkdown:function(e){u.a.preview(document.getElementById("preview"),e,{hljs:{style:"github"}})},fetchTopic:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(o["i"])(e.id).then((function(t){var r=t.data;e.renderMarkdown(r.topic),e.flag=!0}));case 1:case"end":return t.stop()}}),t)})))()}}}),p=d,f=(r("8622"),r("2877")),m=Object(f["a"])(p,l,s,!1,null,null,null),g=m.exports,h=r("29e4"),v=r("910f"),b={name:"List",components:{Update:v["default"],TopicDetail:g,Pagination:h["a"]},data:function(){return{listLoading:!0,total:0,listQuery:{pageNo:1,size:20},dialogTableVisible:!1,dialogUpdateVisible:!1,tableData:[],articleId:0}},computed:{pickerOptions:function(){function e(e){return e.getTime()>(new Date).getTime()}return{disabledDate:e}}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(o["d"])(this.listQuery).then((function(t){var r=t.data;e.total=r.total,e.tableData=r.records,setTimeout((function(){e.listLoading=!1}),1e3)}))},viewTopic:function(e){this.articleId=e.articleId,this.dialogTableVisible=!0},updateTopic:function(e){this.articleId=e.articleId,this.dialogUpdateVisible=!0},switchControl:function(e,t,r){var a=this;this.$confirm("是否继续操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return"draft"===r&&(t.draft=e),i.next=3,Object(o["m"])({type:r,status:e,articleId:t.articleId});case 3:a.$message({type:"success",message:"操作成功!"});case 4:case"end":return i.stop()}}),i)})))).catch((function(){t[r]=!e}))},deleteRow:function(e,t,r){var a=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["c"])(r.articleId).then((function(){t.splice(e,1),a.$message({type:"success",message:"删除成功!"})}))}))},filterTag:function(e,t){return t.draft===e},filterHandler:function(e,t,r){var a=r["property"];return t[a]===e},updateCreateTime:function(e,t){t&&Object(o["l"])(e,t)}}},y=b,w=Object(f["a"])(y,a,i,!1,null,null,null);t["default"]=w.exports}}]);