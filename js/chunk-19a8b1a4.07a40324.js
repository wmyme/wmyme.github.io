(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19a8b1a4"],{"1df0":function(t,e,s){},2144:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"c",(function(){return i})),s.d(e,"b",(function(){return o}));var n=s("b775");function a(t){return Object(n["a"])({url:"/relationship/subscribe/".concat(t),method:"get"})}function i(t){return Object(n["a"])({url:"/relationship/unsubscribe/".concat(t),method:"get"})}function o(t){return console.log(t),Object(n["a"])({url:"/relationship/validate/".concat(t),method:"get"})}},3209:function(t,e,s){},"6ed4":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-three-quarters"},[s("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[s("div",{staticClass:"has-text-centered",attrs:{slot:"header"},slot:"header"},[s("p",{staticClass:"is-size-5 has-text-weight-bold"},[t._v(t._s(t.topic.title))]),s("div",{staticClass:"has-text-grey is-size-7 mt-3"},[s("span",[t._v(t._s(t.dayjs(t.topic.createTime).format("YYYY/MM/DD HH:mm:ss")))]),s("el-divider",{attrs:{direction:"vertical"}}),s("span",[t._v("ÂèëÂ∏ÉËÄÖÔºö"+t._s(t.topicUser.alias))]),s("el-divider",{attrs:{direction:"vertical"}}),s("span",[t._v("Êü•ÁúãÔºö"+t._s(t.topic.view))])],1)]),s("div",{attrs:{id:"preview"}}),s("div",{staticClass:"handle"},[s("i",{staticClass:"iconfont icon-dianzan1",class:{active:t.handleList.like},on:{click:function(e){return t.handleLike("1",e)}}},[t._v(t._s(t.topic.like))]),s("i",{staticClass:"iconfont icon-toubi",class:{active:t.handleList.coin},on:{click:function(e){return t.handleLike("2",e)}}},[t._v(t._s(t.topic.coin))]),s("i",{staticClass:"iconfont icon-shoucang",class:{active:t.handleList.collects},on:{click:function(e){return t.handleLike("3",e)}}},[t._v(t._s(t.topic.collects))])]),s("nav",{staticClass:"level has-text-grey is-size-7 mt-6"},[s("div",{staticClass:"level-left"},[s("p",{staticClass:"level-item"},[s("b-taglist",t._l(t.tags,(function(e,n){return s("router-link",{key:n,attrs:{to:{name:"tag",params:{name:e.name}}}},[s("b-tag",{attrs:{type:"is-info is-light mr-1"}},[t._v(" "+t._s("#"+e.name)+" ")])],1)})),1)],1)]),t.token&&t.user.id===t.topicUser.id?s("div",{staticClass:"level-right"},[s("router-link",{staticClass:"level-item",attrs:{to:{name:"topic-edit",params:{id:t.topic.id}}}},[s("span",{staticClass:"tag"},[t._v("ÁºñËæë")])]),s("a",{staticClass:"level-item"},[s("span",{staticClass:"tag",on:{click:function(e){return t.handleDelete(t.topic.id)}}},[t._v("Âà†Èô§")])])],1):t._e()])]),s("lv-comments",{attrs:{slug:t.topic.id}})],1),s("div",{staticClass:"column"},[t.flag?s("Author",{attrs:{user:t.topicUser}}):t._e(),t.flag?s("recommend",{attrs:{"topic-id":t.topic.id}}):t._e()],1)])},a=[],i=s("1da1"),o=s("5530"),c=(s("b0c0"),s("96cf"),s("caf6")),r=s("e8ec"),l=s("2f62"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"author"}},[s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"has-text-weight-bold"},[t._v("üë®‚Äçüíª ÂÖ≥‰∫é‰ΩúËÄÖ")])]),s("div",{staticClass:"has-text-centered"},[s("p",{staticClass:"is-size-5 mb-5"},[s("router-link",{attrs:{to:{path:"/member/"+t.user.username+"/home"}}},[t._v(" "+t._s(t.user.alias)+" "),s("span",{staticClass:"is-size-7 has-text-grey"},[t._v(t._s("@"+t.user.username))])])],1),s("div",{staticClass:"columns is-mobile"},[s("div",{staticClass:"column is-half"},[s("code",[t._v(t._s(t.user.topicCount))]),s("p",[t._v("ÊñáÁ´†")])]),s("div",{staticClass:"column is-half"},[s("code",[t._v(t._s(t.user.followerCount))]),s("p",[t._v("Á≤â‰∏ù")])])]),s("div",[t.hasFollow?s("button",{staticClass:"button is-success button-center is-fullwidth",on:{click:function(e){return t.handleUnFollow(t.user.id)}}},[t._v(" Â∑≤ÂÖ≥Ê≥® ")]):s("button",{staticClass:"button is-link button-center is-fullwidth",on:{click:function(e){return t.handleFollow(t.user.id)}}},[t._v(" ÂÖ≥Ê≥® ")])])])])],1)},m=[],d=s("2144"),h={name:"Author",props:{user:{type:Object,default:null}},data:function(){return{hasFollow:!1}},mounted:function(){this.fetchInfo()},computed:Object(o["a"])({},Object(l["b"])(["token"])),methods:{fetchInfo:function(){var t=this;null!=this.token&&""!==this.token&&Object(d["b"])(this.user.id).then((function(e){var s=e.data;t.hasFollow=s.hasFollow}))},handleFollow:function(t){var e=this;null!=this.token&&""!==this.token?Object(d["a"])(t).then((function(t){var s=t.message;e.$message.success(s),e.hasFollow=!e.hasFollow,e.user.followerCount=parseInt(e.user.followerCount)+1})).catch((function(){})):this.$message.success("ËØ∑ÂÖàÁôªÂΩï")},handleUnFollow:function(t){var e=this;Object(d["c"])(t).then((function(t){var s=t.message;e.$message.success(s),e.hasFollow=!e.hasFollow,e.user.followerCount=parseInt(e.user.followerCount)-1}))}}},f=h,p=s("2877"),v=Object(p["a"])(f,u,m,!1,null,"58300ab5",null),g=v.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"has-text-weight-bold"},[t._v("üßê Èöè‰æøÁúãÁúã")])]),s("div",t._l(t.recommend,(function(e,n){return s("p",{key:n,staticClass:"block ellipsis is-ellipsis-1",attrs:{title:e.title}},[s("router-link",{attrs:{to:{name:"post-detail",params:{id:e.id}}}},[s("span",{staticClass:"tag"},n<9?[t._v(" 0"+t._s(parseInt(n)+1)+" ")]:[t._v(" "+t._s(parseInt(n)+1)+" ")]),t._v(" "+t._s(e.title)+" ")])],1)})),0)])},_=[],C={name:"Recommend",props:{topicId:{type:String,default:null}},data:function(){return{recommend:[]}},created:function(){this.fetchRecommendTopics()},methods:{fetchRecommendTopics:function(){var t=this;Object(c["e"])(this.topicId).then((function(e){var s=e.data;t.recommend=s}))}}},w=C,k=Object(p["a"])(w,b,_,!1,null,"9b242f7e",null),y=k.exports,x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"box comments"},[s("hr"),s("h3",{staticClass:"title is-5"},[t._v("Comments")]),t.token?s("lv-comments-form",{attrs:{slug:t.slug,show:{}},on:{loadComments:t.fetchComments}}):t._e(),t._l(t.comments,(function(e){return s("lv-comments-item",{key:"comment-"+e.id,attrs:{comment:e,slug:t.slug}})}))],2)},L=[],O=s("b775");function j(t){return Object(O["a"])({url:"/comment/get_comments",method:"get",params:{topicid:t}})}function $(t){return Object(O["a"])({url:"/comment/add_comment",method:"post",data:t})}var T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("article",{staticClass:"media repl"},[s("div",{staticClass:"media-content"},[s("span",[t._v("üòÄ")]),s("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[s("b-field",[Object.keys(t.show).length<=0?s("b-input",{attrs:{type:"textarea",maxlength:"400",placeholder:"Add a comment...",disabled:t.isLoading},model:{value:t.commentText,callback:function(e){t.commentText=e},expression:"commentText"}}):s("b-input",{attrs:{type:"textarea",maxlength:"400",placeholder:"@"+t.show.username,disabled:t.isLoading},model:{value:t.commentText,callback:function(e){t.commentText=e},expression:"commentText"}})],1),s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("b-button",{staticClass:"level-item",attrs:{type:"is-primary","native-type":"submit",disabled:t.isLoading}},[t._v(" Comment ")])],1)])],1)])])},I=[],F={name:"LvCommentsForm",data:function(){return{commentText:"",isLoading:!1,input3:""}},props:{slug:{type:String,default:null},show:{}},methods:{onSubmit:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,s={},console.log(t.commentText),s["content"]=t.commentText,s["topic_id"]=t.slug,s["reply_name"]=t.show.username,s["parent_id"]=t.show.id,console.log(s),e.next=11,$(s);case 11:t.$emit("loadComments",t.slug),t.$message.success("ÁïôË®ÄÊàêÂäü"),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](1),t.$buefy.toast.open({message:"Cannot comment this story. ".concat(e.t0),type:"is-danger"});case 18:return e.prev=18,t.isLoading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[1,15,18,21]])})))()}}},R=F,S=Object(p["a"])(R,T,I,!1,null,null,null),E=S.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("article",{staticClass:"media"},[s("figure",{staticClass:"media-left image is-48x48"},[s("el-image",{attrs:{src:"https://cn.gravatar.com/avatar/"+t.comment.userId+"?s=164&d=monsterid"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])])],1),s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.comment.username))]),s("small",{staticClass:"ml-2"},[t._v(t._s(t._f("date")(t.comment.createTime)))]),s("br"),t._v(" "+t._s(t.comment.content)+" ")]),s("div",[s("span",{staticClass:"controls"},[t._v("üëç19")]),s("span",{staticClass:"controls"},[t._v("üëç0")]),s("span",{ref:"reply",staticClass:"controls",on:{click:t.reply}},[t._v("üí¨0")])])]),t.flag?s("LvCommentsForm",{ref:"repl",attrs:{show:t.comment,slug:t.slug}}):t._e(),t._l(t.comment.replies,(function(e,n){return s("div",{key:n},[s("div",{staticClass:"media reply"},[s("figure",{staticClass:"media-left image is-48x48"},[s("el-image",{attrs:{src:"https://cn.gravatar.com/avatar/"+t.comment.userId+"?s=164&d=monsterid"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])])],1),s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(e.username))]),s("small",{staticClass:"ml-2"},[t._v(t._s(t._f("date")(e.createTime)))]),s("br"),t._v(" "+t._s(e.content)+" ")]),s("div",[s("span",{staticClass:"controls"},[t._v("üëç19")]),s("span",{staticClass:"controls"},[t._v("üëç0")]),s("span",{ref:"reply",refInFor:!0,staticClass:"controls",on:{click:t.reply}},[t._v("üí¨0")])])])])])}))],2)])},M=[],D={name:"LvCommentsItem",components:{LvCommentsForm:E},data:function(){return{flag:!1}},props:{comment:{type:Object,required:!0},slug:{type:String,default:null}},mounted:function(){var t=this;this.$bus.$on("de",(function(){t.flag&&(t.flag=!1)}))},methods:{reply:function(t){this.flag||this.$bus.$emit("de"),this.flag=!this.flag},closeReply:function(){var t=this,e=document.getElementsByClassName("repl");document.addEventListener("click",(function(s){e.length>1?e[1].contains(s.target)||t.$refs.reply.contains(s.target)||(t.flag=!1):t.$refs.reply.contains(s.target)||(t.flag=!1)}))}},beforeDestroy:function(){this.$bus.$off("de")}},U=D,z=(s("e625"),Object(p["a"])(U,A,M,!1,null,"95a9494c",null)),J=z.exports,H={name:"LvComments",components:{LvCommentsForm:E,LvCommentsItem:J},data:function(){return{comments:[]}},props:{slug:{type:String,default:null}},computed:Object(o["a"])({},Object(l["b"])(["token"])),mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchComments(t.slug);case 2:case"end":return e.stop()}}),e)})))()},methods:{fetchComments:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:console.log(t),j(t).then((function(t){var s=t.data;console.log(t),e.comments=s}));case 2:case"end":return s.stop()}}),s)})))()}}},N=H,Y=Object(p["a"])(N,x,L,!1,null,null,null),q=Y.exports,B=s("ff41"),G=s.n(B),K=(s("2f2f"),{name:"TopicDetail",components:{Author:g,Recommend:y,LvComments:q},computed:Object(o["a"])({},Object(l["b"])(["token","user"])),data:function(){return{flag:!1,topic:{content:"",id:this.$route.params.id,like:0,coin:0,collects:0},tags:[],topicUser:{},handleList:{like:!1,coin:!1,collects:!1}}},mounted:function(){this.fetchTopic(),this.getHandleList()},methods:{renderMarkdown:function(t){G.a.preview(document.getElementById("preview"),t,{hljs:{style:"github"}})},fetchTopic:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(c["f"])(t.$route.params.id).then((function(e){var s=e.data;document.title=s.topic.title,t.topic=s.topic,t.tags=s.tags,t.topicUser=s.user,t.renderMarkdown(t.topic.content),t.flag=!0,t.setRecommend(s.tags)}));case 1:case"end":return e.stop()}}),e)})))()},getHandleList:function(){var t=this;null!=this.token&&Object(c["b"])(this.$route.params.id).then((function(e){var s=e.data;t.handleList.like=s.like,t.handleList.coin=s.coin,t.handleList.collects=s.collects}))},handleDelete:function(t){var e=this;Object(c["a"])(t).then((function(t){var s=t.code,n=t.message;alert(n),200===s&&setTimeout((function(){e.$router.push({path:"/"})}),500)}))},handleLike:function(t,e){if(null!=this.token){var s=!0,n=e.target.classList.contains("active");if(!n||(s=!s,"2"!==t)){var a={topicId:this.$route.params.id,handleType:t,done:s};Object(c["g"])(a).then((function(){n?(e.target.innerText=parseInt(e.target.innerText)-1,e.target.classList.remove("active")):(e.target.innerText=parseInt(e.target.innerText)+1,e.target.classList.add("active"))})).catch((function(){}))}}else this.$router.push({path:"/login"})},handleCoin:function(t){t.target.classList.contains("active")?(this.topic.coin-=1,this.handleList.coin=!1):(this.topic.coin+=1,this.handleList.coin=!0)},handleCollection:function(t){null==this.token&&this.router.push({path:"/login"});var e=!1,s=t.target.classList.contains("active");s?(this.topic.collects-=1,this.handleList.collects=!1):(this.topic.collects+=1,this.handleList.collects=!0,e=!e)},setRecommend:function(t){for(var e=0;e<t.length;e++)Object(r["b"])(this.tags[e].name)}}}),P=K,Q=(s("dd3c"),Object(p["a"])(P,n,a,!1,null,null,null));e["default"]=Q.exports},a434:function(t,e,s){"use strict";var n=s("23e7"),a=s("23cb"),i=s("a691"),o=s("50c4"),c=s("7b0b"),r=s("65f0"),l=s("8418"),u=s("1dde"),m=u("splice"),d=Math.max,h=Math.min,f=9007199254740991,p="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!m},{splice:function(t,e){var s,n,u,m,v,g,b=c(this),_=o(b.length),C=a(t,_),w=arguments.length;if(0===w?s=n=0:1===w?(s=0,n=_-C):(s=w-2,n=h(d(i(e),0),_-C)),_+s-n>f)throw TypeError(p);for(u=r(b,n),m=0;m<n;m++)v=C+m,v in b&&l(u,m,b[v]);if(u.length=n,s<n){for(m=C;m<_-n;m++)v=m+n,g=m+s,v in b?b[g]=b[v]:delete b[g];for(m=_;m>_-n+s;m--)delete b[m-1]}else if(s>n)for(m=_-n;m>C;m--)v=m+n-1,g=m+s-1,v in b?b[g]=b[v]:delete b[g];for(m=0;m<s;m++)b[m+C]=arguments[m+2];return b.length=_-n+s,u}})},dd3c:function(t,e,s){"use strict";s("3209")},e625:function(t,e,s){"use strict";s("1df0")},e8ec:function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return a}));s("fb6a"),s("b0c0"),s("99af"),s("a434");function n(){var t=JSON.parse(localStorage.getItem("recommendList"))||[];function e(t){return function(e,s){return s[t]-e[t]}}return t.sort(e("count")),t.slice(0,5)}function a(t){var e=n()||[];if(e.length>0)for(var s=0;s<e.length;s++)if(e[s].name===t)return e[s].count+=1,void localStorage.setItem("recommendList",JSON.stringify(e));e.push({name:t,count:1}),localStorage.setItem("recommendList",JSON.stringify(e))}},fb6a:function(t,e,s){"use strict";var n=s("23e7"),a=s("861d"),i=s("e8b5"),o=s("23cb"),c=s("50c4"),r=s("fc6a"),l=s("8418"),u=s("b622"),m=s("1dde"),d=m("slice"),h=u("species"),f=[].slice,p=Math.max;n({target:"Array",proto:!0,forced:!d},{slice:function(t,e){var s,n,u,m=r(this),d=c(m.length),v=o(t,d),g=o(void 0===e?d:e,d);if(i(m)&&(s=m.constructor,"function"!=typeof s||s!==Array&&!i(s.prototype)?a(s)&&(s=s[h],null===s&&(s=void 0)):s=void 0,s===Array||void 0===s))return f.call(m,v,g);for(n=new(void 0===s?Array:s)(p(g-v,0)),u=0;v<g;v++,u++)v in m&&l(n,u,m[v]);return n.length=u,n}})}}]);
//# sourceMappingURL=chunk-19a8b1a4.07a40324.js.map